{% load custom_filters static %}
<!DOCTYPE html>
<html lang="da">
<head>
  <meta charset="UTF-8">
  <title>Komponentbibliotek</title>
  <link rel="stylesheet" href="{% static '/componentlib/css/componentlib.css' %}">
  <script src="https://unpkg.com/htmx.org@1.9.10"></script>

</head>
<body>

<header>
  <h1>Komponentbibliotek</h1>
</header>

<section>
  <form hx-get="." hx-target="#results" hx-push-url="true">
    <input type="text" name="q" value="{{ q }}" placeholder="S√∏g komponenter..." />
    <button type="submit">S√∏g</button>
  </form>
</section>

{% if selected_tags %}
  <section aria-label="Aktive tags">
    <p><strong>Aktive tags:</strong>
      {% for tag in selected_tags %}
        <span class="active-tag">{{ tag }}</span>{% if not forloop.last %}, {% endif %}
      {% endfor %}
      [<a href="?">Fjern alle</a>]
    </p>
  </section>
{% endif %}

<section aria-label="Filtr√©r efter tags">
  <h2>üè∑ Filtr√©r efter tags:</h2>
  <nav class="tag-nav">
    {% for t in all_tags %}
      {% with t_lower=t|lower %}
        {% if t_lower in selected_tags %}
          <a href="?tags={{ selected_tags|exclude:t_lower|join:',' }}" class="tag-link selected">‚úî {{ t }}</a>
        {% else %}
          {% with tag_string=selected_tags|join:',' %}
            <a href="?tags={% if tag_string %}{{ tag_string }},{% endif %}{{ t }}" class="tag-link">{{ t }}</a>
          {% endwith %}
        {% endif %}
      {% endwith %}
    {% endfor %}
  </nav>
</section>

<hr>

<section>
  <a href="?only=incomplete" class="incomplete-link">
    üöß Vis kun ufuldst√¶ndige komponenter
  </a>
</section>

<section aria-label="Komponentliste">
  <h2>Alfabetisk oversigt over tilg√¶ngelige komponenter</h2>
  <ul class="component-list">
    {% for comp in components %}
      <li class="component-list-item">
        {% include "patternlib_browser/fragments/component_card.html" with comp=comp %}
      </li>
    {% endfor %}
  </ul>
</section>

<hr>

{% if q or selected_tags %}
  <section id="results" aria-label="S√∏geresultater">
    <h2>S√∏geresultater</h2>

    {% if only_fuzzy %}
      <p><em>Ingen eksakte matches ‚Äì her er forslag baseret p√• fuzzy s√∏gning:</em></p>
    {% endif %}

    {% if matches %}
      {% for comp in matches %}
        {% include "patternlib_browser/fragments/component_card.html" with comp=comp %}
      {% endfor %}
    {% else %}
      <p>Ingen komponenter fundet.</p>
    {% endif %}
  </section>
{% endif %}

</body>
</html>
